<!DOCTYPE html>
<html lang="ja">
	<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="manifest" href="manifest.json">

	<script>
		if ('serviceWorker' in navigator) {
		window.addEventListener('load', () => {
		navigator.serviceWorker.register('sw.js').then(registration => {
		console.log('ServiceWorker registration successful with scope: ', registration.scope);
		}, err => {
		console.log('ServiceWorker registration failed: ', err);
		}).catch(err => {
		console.log(err)
			});
		});
}
    </script>


        <title>IPTV チャンネル一覧</title>
        <style>
            body {
                font-family: sans-serif;
                background-color: #121212;
                color: #fff;
                margin: 0;
                padding: 20px;
            }
            h1 {
                text-align: center;
                margin-bottom: 20px;
            }
            #channel-list {
                display: flex;
                flex-direction: column;
                gap: 20px;
                max-height: 80vh;
                max-width: 500px;
                overflow-y: auto;
                padding: 0 5px;
                margin: auto;
            }
            button {
                background-color: #1e88e5;
                color: white;
                border: none;
                padding: 18px;
                font-size: 20px;
                border-radius: 8px;
                cursor: pointer;
                text-align: center;
                transition: background 0.2s;
                width: 100%;
            }
            button:hover {
                background-color: #1565c0;
            }
        </style>
    </head>
    <body>
        <h1>IPTV チャンネル一覧</h1>
        <div id="channel-list">読み込み中...</div>
        <script>
            async function loadChannels() {
                const listElement = document.getElementById("channel-list");
                try {
                    const res = await fetch("https://raw.githubusercontent.com/luongz/iptv-jp/main/jp_clean.m3u");
                    const text = await res.text();
                    const lines = text.split("\n");
                    const channels = [];
                    for (let i = 0; i < lines.length; i++) {
                        if (lines[i].startsWith("#EXTINF")) {
                            const name = lines[i].split(",")[1]?.trim();
                            const url = lines[i + 1]?.trim();
                            channels.push({ name, url });
                        }
                    }
                    // 最初の4つは削除
                    const filtered = channels.slice(4);
                    listElement.innerHTML = "";
                    filtered.forEach((ch) => {
                        const btn = document.createElement("button");
                        btn.textContent = ch.name;
                        btn.onclick = () => window.open(ch.url, "_blank");
                        listElement.appendChild(btn);
                    });
                } catch (err) {
                    listElement.innerHTML = "読み込みエラー: " + err;
                }
            }
            loadChannels();
        </script>


</body>
</html>
